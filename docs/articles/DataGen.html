<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="WhatsMatching">
<title>Data Generation • WhatsMatching</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data Generation">
<meta property="og:description" content="WhatsMatching">
<meta property="og:image" content="https://jmeyer2482.github.io/WhatsMatching/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">WhatsMatching</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/index.html">All Vignettes</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>The Project</h6>
    <a class="dropdown-item" href="../articles/Background.html">Background</a>
    <a class="dropdown-item" href="../articles/Development.html">Development</a>
    <a class="dropdown-item" href="../articles/Summary.html">Summary</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>The Shiny App</h6>
    <a class="dropdown-item" href="../articles/TheApp.html">The App</a>
    <a class="dropdown-item" href="../articles/DataGen.html">Data Generation</a>
    <a class="dropdown-item" href="../articles/Matching.html">Matching</a>
    <a class="dropdown-item" href="../articles/Examples.html">Examples</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>The Package</h6>
    <a class="dropdown-item" href="../articles/functions.html">Using the Functions</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-packages-used">Packages Used</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-packages-used">
    <a class="external-link dropdown-item" href="https://plotly-r.com">plotly</a>
    <a class="external-link dropdown-item" href="https://ggplot2.tidyverse.org">ggplot2</a>
    <a class="external-link dropdown-item" href="https://CRAN.R-project.org/package=dplyr">dplyr</a>
    <a class="external-link dropdown-item" href="https://shiny.rstudio.com/">shiny</a>
    <a class="external-link dropdown-item" href="https://deanattali.com/shinyjs/">shinyjs</a>
    <a class="external-link dropdown-item" href="https://ebailey78.github.io/shinyBS/">shinyBS</a>
    <a class="external-link dropdown-item" href="https://engineering-shiny.org/">golem</a>
    <a class="external-link dropdown-item" href="https://github.com/markmfredrickson/optmatch">optmatch</a>
    <a class="external-link dropdown-item" href="https://cran.r-project.org/package=pkgdown">pkgdown</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jmeyer2482/WhatsMatching">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Data Generation</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jmeyer2482/WhatsMatching/blob/HEAD/vignettes/DataGen.Rmd" class="external-link"><code>vignettes/DataGen.Rmd</code></a></small>
      <div class="d-none name"><code>DataGen.Rmd</code></div>
    </div>

    
    
<script src="https://kit.fontawesome.com/e10eea7053.js" crossorigin="anonymous"></script><p>From the main page, clicking on the <i class="fas fa-cog"></i> icon
under the title opens up a modal dialogue box that is displayed in the
following figures. This modal gives the user access to data from four
different simulations and a real dataset. I will briefly outline each of
the simulations below.</p>
<div class="section level4">
<h4 id="simulation-1">Simulation 1<a class="anchor" aria-label="anchor" href="#simulation-1"></a>
</h4>
<p>This simulation is based on the data generation process described by
King and Neilsen<span class="citation"><sup><a href="#ref-King2019" role="doc-biblioref">1</a></sup></span>. Essentially, it contains two
experiments—a fully blocked randomised experiment and a completely
randomised experiment—hidden within an imbalanced “observational”
dataset. If you look at Figure 3, the first plot (top left) makes this
clearer. The fully blocked randomised experiment is in the top right
corner of the plot which is demonstrated by the treated (red) and
untreated (blue) units being virtually right on top of one another. The
completely randomised experiment is just below it in the bottom right
corner of the plot and you can clearly see that there are similar
numbers of treated and control units but they are not exactly matched.
The imbalanced observational data is represented by the placement of the
untreated unit on the left of the plot.</p>
<table style="border: none;" class="table">
<caption style="text-align:left; caption-side:top;"> Figure 1. Simulation 1 Preview</caption>
  <tr>
<td style="text-align:center"><img src="../reference/figures/App_Sim1.png" border="0" width="100%"></td>
  </tr>
</table>
<p>The purpose of this simulation in the paper was to demonstrate the
ability of different matching methods to select the units in a logical
order. Ideally, the data from the fully blocked randomised experiment
should be matched first, then the data from the completely randomised
experiment. It has been included in the app as it provides a clear
demonstration of the performance of mahalanobis-based distance matching
versus propensity score-based distance matching.</p>
<p>In the app, you are able to change the treatment effect but that
should not change the outcome of the matching process in any way, only
the calculation of the treatment estimate.</p>
</div>
<div class="section level4">
<h4 id="simulation-2">Simulation 2<a class="anchor" aria-label="anchor" href="#simulation-2"></a>
</h4>
<p>Simulation 2 is also taken from King and Neilsen<span class="citation"><sup><a href="#ref-King2019" role="doc-biblioref">1</a></sup></span> however the data is very
different. This simulation uses two overlapping uniform distributions
that both affect the treatment received and the outcome. When
visualising the two covariates, <code>X1</code> and <code>X2</code>, on
a two dimensional field, the data has the appearance of a square of
treated units overlapped by a square of untreated units. This can be
clearly seen in the top left plot in Figure 4 below.</p>
<table style="border: none;" class="table">
<caption style="text-align:left; caption-side:top;"> Figure 2. Simulation 2 Preview</caption>
  <tr>
<td style="text-align:center"><img src="../reference/figures/App_Sim2.png" border="0" width="100%"></td>
  </tr>
</table>
<p>Users have the ability to change the range of the uniform
distribution, the strength of association between the covariates
(<code>X1</code> and <code>X2</code>) and the treatment variable
(<code>t</code>), and the treatment effect on the outcome
(<code>y</code>). Probably the most useful illustration of this data is
to compare the same method of matching but change whether replacement is
used or not. It can be particularly striking if there is a strong
association between the covariates and treatment.</p>
</div>
<div class="section level4">
<h4 id="simulation-3">Simulation 3<a class="anchor" aria-label="anchor" href="#simulation-3"></a>
</h4>
<p>This simulation uses causal relationships to define the effects
between the treatment, covariates, and outcome. There are five options
available to the user that can change the data generation relationships
between the treatment indicator <code>t</code>, the outcome
<code>y</code> and two covariates <code>X1</code> and <code>X2</code>.
Figure 5 demonstrates how each of the options fit into a causal diagram
with an arrow pointing in the direction of the assumed effect in the
data generation process.</p>
<table style="border: none;" class="table">
<caption style="text-align:left; caption-side:top;">Figure 3. Simulation 3 Casual Relationships</caption>
  <tr>
<td style="text-align:center"><img src="../reference/figures/Sim3_causal.jpeg" border="0" width="100%"></td>
  </tr>
</table>
<p>To generate the data, first we create the covariates, <code>X1</code>
and <code>X2</code>, as a bivariate normal distribution with a covariate
correlation of 0.2. The treatment variable is then generated based on
the selection after which the function then iteratively works through
the selected options and applies changes to the data as appropriate. It
should be noted that the user can not change the strength of the effects
in this simulation. Nor can the relationship between <code>t</code> and
<code>y</code> be changed, although they can both be altered via
<code>X1</code> and <code>X2</code>. Other than the causal relationship,
only the treatment effect can be modified. This has been done to allow
for simple data generation. Figure 6 below gives an overview of what the
generated data may look like.</p>
<table style="border: none;" class="table">
<caption style="text-align:left; caption-side:top;">Figure 4. Simulation 3 Preview</caption>
  <tr>
<td style="text-align:center"><img src="../reference/figures/App_Sim3.png" border="0" width="100%"></td>
  </tr>
</table>
</div>
<div class="section level4">
<h4 id="simulation-4">Simulation 4<a class="anchor" aria-label="anchor" href="#simulation-4"></a>
</h4>
<p>This is the last simulation. Like simulation 3, <code>X1</code> and
<code>X2</code> are taken from a bivariate normal distribution. However,
in this simulation, <code>X1</code> and <code>X2</code> can effectively
act as confounder, an ancestor of <code>t</code>, or an ancestor of
<code>y</code>. This is achieved by altering the weights of the effect
on the treatment or the effect on the outcome. In addition, you can
change the covariance correlation which will increase the correlation of
<code>X1</code> and <code>X2</code>. See Figure 7 below for a preview of
what the data from Simulation 4 may look like.</p>
<table style="border: none;" class="table">
<caption style="text-align:left; caption-side:top;">Figure 5. Simulation 4 Preview</caption>
  <tr>
<td style="text-align:center"><img src="../reference/figures/App_Sim4.png" border="0" width="100%"></td>
  </tr>
</table>
</div>
<div class="section level4">
<h4 id="real-data---fev">Real Data - FEV<a class="anchor" aria-label="anchor" href="#real-data---fev"></a>
</h4>
<p>The <em>Forced Expiratory Volume</em> dataset is available from the
<code>mplot</code><span class="citation"><sup><a href="#ref-mplot" role="doc-biblioref">2</a></sup></span> package. For the purposes of the
app, it has been utilised to demonstrate how matching works on real data
using <code>smoke</code> as the treatment variable and <code>fev</code>
as the outcome. This dataset was ideal for this project because it was
relatively small, contains only a few variables, and contains a
treatment and outcome variable. A preview of the data is below in Figure
8.</p>
<table style="border: none;" class="table">
<caption style="text-align:left; caption-side:top;">Figure 6. Forced Expiratory Volume Preview</caption>
  <tr>
<td style="text-align:center"><img src="../reference/figures/App_fev.png" border="0" width="100%"></td>
  </tr>
</table>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-King2019" class="csl-entry">
1. King G, Nielsen R. <span class="nocase">Why Propensity Scores Should
Not Be Used for Matching</span>. <em>Political Analysis</em>.
2019;27(4):435-454. doi:<a href="https://doi.org/10.1017/pan.2019.11" class="external-link">10.1017/pan.2019.11</a>
</div>
<div id="ref-mplot" class="csl-entry">
2. Tarr G, Müller S, Welsh AH. <span class="nocase">mplot</span>: An
<span>R</span> package for graphical model stability and variable
selection procedures. <em>Journal of Statistical Software</em>.
2018;83(9):1-28. doi:<a href="https://doi.org/10.18637/jss.v083.i09" class="external-link">10.18637/jss.v083.i09</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jason Meyer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
